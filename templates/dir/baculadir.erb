#
# puppet managed file
#

Director {
  Name = <%= @director_name %>
  DIRport = <%= @port %>
  QueryFile = "/etc/bacula/scripts/query.sql"
  WorkingDirectory = "<%= scope.lookupvar('bacula::params::dir_workdir') %>"
  Pid Directory = "<%= scope.lookupvar('bacula::params::dir_pid') %>"
  Maximum Concurrent Jobs = <%= @max_concurrent_jobs %>
  Password = "<%= @director_password %>"
  Messages = Daemon
  <%- if defined?(@diraddr) -%>
  DirAddress = <%= @diraddr %>
  <%- end -%>
}

# Reasonable message delivery -- send most everything to email address
#  and to the console
Messages {
  Name = Standard
#
# NOTE! If you send to two email or more email addresses, you will need
#  to replace the %r in the from field (-f part) with a single valid
#  email address in both the mailcommand and the operatorcommand.
#  What this does is, it sets the email address that emails would display
#  in the FROM field, which is by default the same email as they're being
#  sent to.  However, if you send email to more than one address, then
#  you'll have to set the FROM address manually, to a single address.
#  for example, a 'no-reply@mydomain.com', is better since that tends to
#  tell (most) people that its coming from an automated source.

#
  mailcommand = "/usr/sbin/bsmtp -h localhost -f \"\(Bacula\) \<%r\>\" -s \"Bacula: %t %e of %c %l\" %r"
  operatorcommand = "/usr/sbin/bsmtp -h localhost -f \"\(Bacula\) \<%r\>\" -s \"Bacula: Intervention needed for %j\" %r"
  mail = root = all, !skipped
  operator = root = mount
  console = all, !skipped, !saved

  append = "<%= @bacula_log %>" = all, !skipped
  catalog = all
}


#
# Message delivery for daemon messages (no job).
#
Messages {
  Name = Daemon
  mailcommand = "/usr/sbin/bsmtp -h localhost -f \"\(Bacula\) \<%r\>\" -s \"Bacula daemon message\" %r"
  mail = root = all, !skipped
  console = all, !skipped, !saved
  append = "<%= @bacula_log %>" = all, !skipped
}
